import numpy as np
import matplotlib.pyplot as plt

coeffs = np.array([
     0.00130914,
 0.00131436,
 0.00131963,
 0.00132495,
  0.0013303,
  0.0013357,
 0.00134115,
 0.00134664,
 0.00135217,
 0.00135775,
 0.00136338,
 0.00136905,
 0.00137477,
 0.00138054,
 0.00138636,
 0.00139223,
 0.00139814,
 0.00140411,
 0.00141013,
  0.0014162,
 0.00142233,
 0.00142851,
 0.00143474,
 0.00144102,
 0.00144737,
 0.00145377,
 0.00146022,
 0.00146673,
 0.00147331,
 0.00147994,
 0.00148663,
 0.00149338,
 0.00150019,
 0.00150707,
 0.00151401,
 0.00152102,
 0.00152809,
 0.00153522,
 0.00154243,
  0.0015497,
 0.00155704,
 0.00156445,
 0.00157193,
 0.00157948,
 0.00158711,
 0.00159481,
 0.00160259,
 0.00161044,
 0.00161837,
 0.00162638,
 0.00163447,
 0.00164264,
  0.0016509,
 0.00165923,
 0.00166766,
 0.00167616,
 0.00168476,
 0.00169344,
 0.00170222,
 0.00171108,
 0.00172004,
  0.0017291,
 0.00173825,
 0.00174749,
 0.00175684,
 0.00176629,
 0.00177584,
 0.00178549,
 0.00179525,
 0.00180512,
  0.0018151,
 0.00182518,
 0.00183539,
  0.0018457,
 0.00185613,
 0.00186669,
 0.00187736,
 0.00188816,
 0.00189908,
 0.00191013,
  0.0019213,
 0.00193261,
 0.00194406,
 0.00195564,
 0.00196736,
 0.00197922,
 0.00199123,
 0.00200338,
 0.00201569,
 0.00202814,
 0.00204075,
 0.00205352,
 0.00206645,
 0.00207954,
 0.00209281,
 0.00210624,
 0.00211984,
 0.00213363,
 0.00214759,
 0.00216174,
 0.00217608,
 0.00219061,
 0.00220533,
 0.00222026,
 0.00223539,
 0.00225072,
 0.00226627,
 0.00228204,
 0.00229802,
 0.00231424,
 0.00233068,
 0.00234736,
 0.00236428,
 0.00238145,
 0.00239887,
 0.00241654,
 0.00243448,
 0.00245269,
 0.00247117,
 0.00248993,
 0.00250899,
 0.00252833,
 0.00254798,
 0.00256793,
 0.00258821,
  0.0026088,
 0.00262972,
 0.00265099,
  0.0026726,
 0.00269457,
  0.0027169,
 0.00273961,
  0.0027627,
 0.00278618,
 0.00281007,
 0.00283437,
 0.00285909,
 0.00288425,
 0.00290986,
 0.00293593,
 0.00296247,
  0.0029895,
 0.00301702,
 0.00304506,
 0.00307362,
 0.00310272,
 0.00313239,
 0.00316262,
 0.00319345,
 0.00322488,
 0.00325694,
 0.00328965,
 0.00332302,
 0.00335707,
 0.00339183,
 0.00342732,
 0.00346356,
 0.00350057,
 0.00353839,
 0.00357704,
 0.00361653,
 0.00365692,
 0.00369821,
 0.00374045,
 0.00378367,
  0.0038279,
 0.00387317,
 0.00391954,
 0.00396702,
 0.00401568,
 0.00406554,
 0.00411666,
 0.00416908,
 0.00422285,
 0.00427804,
 0.00433468,
 0.00439285,
  0.0044526,
   0.004514,
 0.00457712,
 0.00464203,
 0.00470882,
 0.00477755,
 0.00484832,
 0.00492123,
 0.00499636,
 0.00507382,
 0.00515373,
 0.00523619,
 0.00532134,
 0.00540931,
 0.00550024,
 0.00559428,
 0.00569159,
 0.00579235,
 0.00589675,
 0.00600499,
 0.00611727,
 0.00623384,
 0.00635494,
 0.00648084,
 0.00661183,
 0.00674824,
 0.00689039,
 0.00703867,
 0.00719348,
 0.00735525,
 0.00752447,
 0.00770167,
 0.00788741,
 0.00808235,
 0.00828717,
 0.00850265,
 0.00872964,
 0.00896909,
 0.00922206,
 0.00948972,
 0.00977338,
  0.0100745,
  0.0103949,
  0.0107362,
  0.0111008,
   0.011491,
  0.0119096,
  0.0123599,
  0.0128456,
  0.0133711,
  0.0139414,
  0.0145626,
  0.0152417,
  0.0159872,
  0.0168095,
  0.0177209,
  0.0187369,
  0.0198765,
  0.0211638,
  0.0226293,
   0.024313,
  0.0262674,
  0.0285635,
  0.0312995,
  0.0346152,
  0.0387167,
  0.0439206,
  0.0507405,
  0.0600668,
  0.0735913,
  0.0949681,
   0.133812,
   0.226092,
    0.70194,
  -0.556206,
   -0.20769,
  -0.127115,
 -0.0915373,
 -0.0715097,
 -0.0586693,
 -0.0497368,
 -0.0431641,
 -0.0381255,
 -0.0341399,
 -0.0309086,
  -0.028236,
 -0.0259887,
 -0.0240726,
 -0.0224197,
 -0.0209791,
 -0.0197124,
 -0.0185899,
 -0.0175883,
 -0.0166891,
 -0.0158774,
 -0.0151409,
 -0.0144697,
 -0.0138555,
 -0.0132913,
 -0.0127712,
 -0.0122903,
 -0.0118442,
 -0.0114294,
 -0.0110427,
 -0.0106812,
 -0.0103427,
 -0.0100249,
-0.00972612,
-0.00944459,
 -0.0091789,
-0.00892773,
-0.00868994,
-0.00846448,
-0.00825042,
-0.00804691,
 -0.0078532,
-0.00766858,
-0.00749244,
-0.00732421,
-0.00716336,
-0.00700942,
-0.00686195,
-0.00672055,
-0.00658486,
-0.00645454,
-0.00632927,
-0.00620877,
-0.00609277,
-0.00598102,
-0.00587329,
-0.00576937,
-0.00566906,
-0.00557218,
-0.00547855,
-0.00538801,
-0.00530041,
-0.00521562,
-0.00513349,
 -0.0050539,
-0.00497674,
-0.00490191,
-0.00482928,
-0.00475878,
 -0.0046903,
-0.00462376,
-0.00455908,
-0.00449619,
  -0.004435,
-0.00437546,
-0.00431749,
-0.00426104,
-0.00420604,
-0.00415244,
-0.00410019,
-0.00404923,
-0.00399953,
-0.00395103,
-0.00390369,
-0.00385747,
-0.00381233,
-0.00376823,
-0.00372514,
-0.00368303,
-0.00364185,
-0.00360158,
 -0.0035622,
-0.00352366,
-0.00348595,
-0.00344903,
-0.00341289,
 -0.0033775,
-0.00334283,
-0.00330887,
-0.00327558,
-0.00324296,
-0.00321098,
-0.00317963,
-0.00314888,
-0.00311872,
-0.00308913,
 -0.0030601,
 -0.0030316,
-0.00300363,
-0.00297617,
-0.00294921,
-0.00292273,
-0.00289672,
-0.00287117,
-0.00284607,
 -0.0028214,
-0.00279715,
-0.00277332,
-0.00274989,
-0.00272685,
-0.00270419,
 -0.0026819,
-0.00265998,
-0.00263842,
 -0.0026172,
-0.00259631,
-0.00257576,
-0.00255553,
-0.00253561,
-0.00251601,
 -0.0024967,
-0.00247769,
-0.00245896,
-0.00244051,
-0.00242234,
-0.00240443,
-0.00238679,
-0.00236941,
-0.00235227,
-0.00233538,
-0.00231873,
-0.00230232,
-0.00228613,
-0.00227018,
-0.00225444,
-0.00223892,
-0.00222361,
-0.00220851,
-0.00219361,
-0.00217891,
-0.00216441,
-0.00215009,
-0.00213597,
-0.00212203,
-0.00210827,
-0.00209468,
-0.00208127,
-0.00206803,
-0.00205496,
-0.00204205,
 -0.0020293,
-0.00201671,
-0.00200428,
-0.00199199,
-0.00197986,
-0.00196787,
-0.00195603,
-0.00194432,
-0.00193276,
-0.00192133,
-0.00191004,
-0.00189888,
-0.00188785,
-0.00187694,
-0.00186616,
 -0.0018555,
-0.00184497,
-0.00183455,
-0.00182425,
-0.00181406,
-0.00180399,
-0.00179403,
-0.00178417,
-0.00177443,
-0.00176478,
-0.00175525,
-0.00174581,
-0.00173648,
-0.00172725,
-0.00171811,
-0.00170907,
-0.00170012,
-0.00169126,
 -0.0016825,
-0.00167383,
-0.00166525,
-0.00165675,
-0.00164834,
-0.00164001,
-0.00163177,
-0.00162361,
-0.00161553,
-0.00160753,
-0.00159961,
-0.00159177,
  -0.001584,
-0.00157631,
-0.00156869,
-0.00156115,
-0.00155367,
-0.00154627,
-0.00153894,
-0.00153168,
-0.00152448,
-0.00151735,
-0.00151029,
 -0.0015033,
-0.00149636,
 -0.0014895,
-0.00148269,
-0.00147594,
-0.00146926,
-0.00146264,
-0.00145607,
-0.00144957,
-0.00144312,
-0.00143673,
-0.00143039,
-0.00142411,
-0.00141789,
-0.00141172,
 -0.0014056,
-0.00139954,
-0.00139352,
-0.00138756,
-0.00138165,
-0.00137579,
-0.00136998,
-0.00136422,
 -0.0013585,
-0.00135283,
-0.00134721,
-0.00134164,
-0.00133611,
-0.00133063,
-0.00132519,
-0.00131979,
-0.00131444,
-0.00130914
                ])


w_D = 0.03
eps_F = 2.
Delta = 4.18987368671297e-03

eps = 0.5 * np.linspace(np.sqrt(2 * (eps_F - w_D)), np.sqrt(2 * (eps_F + w_D)), 500)**2 - eps_F

plt.plot(eps, coeffs, "x", label="$v_i$")
plt.plot(eps, eps / np.sqrt(eps*eps + Delta*Delta), label="$1 - 2<n_k>$")
norm_factor = coeffs[0] / (Delta / (2 * np.sqrt(eps[0]*eps[0] + Delta*Delta)))
plt.plot(eps, coeffs * eps / np.sqrt(eps*eps + Delta*Delta) / norm_factor, label="$\\mathrm{const} \\cdot v_i \\cdot (1 - 2<n_k>)$")
plt.plot(eps, -Delta / (2 * np.sqrt(eps*eps + Delta*Delta)), "--", label="$<f_k>$")

plt.legend()
plt.xlabel("$\\epsilon(k) - \\epsilon_F$ [eV]")
plt.tight_layout()
plt.show()